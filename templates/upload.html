<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GEOVISION Classifier</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='stylehp.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

     <!-- Navbar -->
     <div class="navbar">
        <div class="menu">
            <a href="javascript:void(0)">Menu</a>
            <div class="submenu">
                <a href="{{ url_for('profile') }}">Home</a>
                <a href="{{ url_for('history') }}">Prediction History</a>
                
               
            </div>
        </div>
    </div>

    <div class="container-fluid mt-5" style="margin-top: 200px;">
        <div class="d-flex flex-column align-items-center">
            <div class="card text-center p-4">
                <h3 class="mb-4" style="color:white">Upload and Classify Image</h3>

                <!-- Corrected Form with enctype -->
                <!-- <form id="uploadForm" enctype="multipart/form-data"> -->
                <form id="uploadForm">
<!-- input file box  -->
                    <div class="mb-3">
                        <input type="file" class="form-control" id="imageInput" accept="image/*" required>
                    </div>
<!-- preview section -->
                    <img id="previewImage" class="img-fluid" style="display: none;" alt="Uploaded Image Preview">
                    <div class="loading-spinner" id="loadingSpinner" style="display: none;"></div>
<!--  submit button -->
                    <div class="mt-3">
                        <button type="submit" class="btn btn-success btn-lg w-100">Classify Image</button>
                    </div>
                </form>
<!-- predicton msg  -->
                <div class="mt-4">
                    <h5 style="color:white">Prediction:</h5>
                    <p id="predictionResult" class="fw-bold text-warning"></p>
                </div>
            </div>
        </div>
</div>
        <div class="globe-container me-5">
            <img src="{{ url_for('static', filename='globe.gif') }}"alt="Rotating Globe" width="300">
        </div>


    <footer class="space-footer text-center py-6 mt-12">
        <div class="text-cyan-300">
            <p>@2025 Geovision</p>
           
        </div>  
    </footer>

    <script>
        // Show Image Preview
        document.getElementById('imageInput').addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.getElementById('previewImage');
                    img.src = e.target.result;
                    img.style.display = 'block';
                }
                reader.readAsDataURL(file);
            }
        });

        // Handle Image Upload via Form Submission
        // Handle Image Upload via Form Submission
document.getElementById('uploadForm').addEventListener('submit', function(event) {
    event.preventDefault(); // Prevent default form submission

    let fileInput = document.getElementById("imageInput").files[0];
    let predictionResult = document.getElementById("predictionResult");

    if (!fileInput) {
        alert("Please select an image!");
        return;
    }

    let formData = new FormData();
    formData.append("image", fileInput);

    document.getElementById("loadingSpinner").style.display = "block"; // Show spinner

    fetch("http://127.0.0.1:5000/uploads", 
    {  // Fixed URL
        method: "POST",
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        document.getElementById("loadingSpinner").style.display = "none"; // Hide spinner

        if (data.success) {
            predictionResult.innerText = "✅ Prediction: " + data.prediction;
        } else {
            predictionResult.innerText = "❌ Error: " + data.error;
        }
    })
    .catch(error => {
        console.error("Error:", error);
        document.getElementById("loadingSpinner").style.display = "none";
        predictionResult.innerText = "❌ Error while making prediction.";
    });
});

    </script>

</body>
</html>
